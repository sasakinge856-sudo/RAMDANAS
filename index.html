<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Ramadan Hub v2</title>

  <style>
    :root{
      --bg1:#05070f;
      --bg2:#071b2f;
      --bg3:#220a25;

      --text:#eef5ff;
      --muted:rgba(238,245,255,.72);

      --glass1: rgba(255,255,255,.12);
      --glass2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);

      --a1:#66e2ff;
      --a2:#f6d37a;
      --a3:#ff6ad5;
      --ok:#7dffb3;
      --bad:#ff6b6b;

      --shadow: 0 18px 70px rgba(0,0,0,.50);
      --shadow2: 0 10px 40px rgba(0,0,0,.40);
    }

    *{ box-sizing:border-box; }
    html, body { height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      color: var(--text);
      overflow:hidden;
      background:
        radial-gradient(1000px 700px at 80% 0%, rgba(255,106,213,.12), transparent 60%),
        radial-gradient(950px 650px at 10% 90%, rgba(102,226,255,.12), transparent 60%),
        radial-gradient(900px 650px at 60% 60%, rgba(246,211,122,.10), transparent 60%),
        linear-gradient(140deg, var(--bg1), var(--bg2), var(--bg3));
    }

    /* Fullscreen app */
    .app{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      padding: 18px 14px 70px;
    }

    /* Floating background emojis */
    .emoji-sky{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      opacity: .95;
    }
    .e{
      position:absolute;
      font-size: clamp(18px, 3.6vw, 34px);
      filter: drop-shadow(0 12px 20px rgba(0,0,0,.35));
      animation: floatUp linear infinite;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      from{ transform: translate3d(var(--dx), 110vh, 0) rotate(var(--r)); opacity:0; }
      15%{ opacity: .95; }
      to{ transform: translate3d(var(--dx), -25vh, 0) rotate(calc(var(--r) + 120deg)); opacity:0; }
    }

    .vignette{
      position:fixed; inset:0; pointer-events:none;
      background: radial-gradient(circle at 50% 35%, transparent 35%, rgba(0,0,0,.62) 88%);
      mix-blend-mode: multiply;
    }

    .footer{
      position:fixed;
      left:0; right:0; bottom:10px;
      text-align:center;
      font-size: 13px;
      color: rgba(238,245,255,.65);
      text-shadow: 0 10px 25px rgba(0,0,0,.55);
      pointer-events:none;
      padding: 0 10px;
    }

    /* Panels */
    .panel{
      width:min(980px, 96vw);
      display:none;
      animation: in .38s ease both;
    }
    .panel.active{ display:block; }
    @keyframes in{
      from{ opacity:0; transform: translate3d(0, 12px, 0) scale(.99); }
      to{ opacity:1; transform: translate3d(0,0,0) scale(1); }
    }

    .card{
      background: linear-gradient(180deg, var(--glass1), var(--glass2));
      border: 1px solid var(--stroke);
      border-radius: 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 18px 16px;
      overflow:hidden;
      position:relative;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: rgba(238,245,255,.82);
      font-weight: 900;
      font-size: 12px;
      letter-spacing: .2px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 14px;
    }
    .brand{
      display:flex; flex-direction:column; gap:4px;
    }
    .brand h1{
      margin:0;
      font-size: clamp(20px, 4.8vw, 34px);
      letter-spacing: .2px;
    }
    .brand p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.4;
    }

    .btn{
      border:none;
      border-radius: 16px;
      padding: 12px 14px;
      font-weight: 1000;
      cursor:pointer;
      color:#130c07;
      background: linear-gradient(135deg, var(--a2), rgba(246,211,122,.65));
      box-shadow: var(--shadow2);
      transition: transform .12s ease;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(.99); }
    .btn.ghost{
      color: var(--text);
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.16);
    }
    .btn.pink{
      color: white;
      background: linear-gradient(135deg, var(--a3), rgba(255,106,213,.55));
      filter: drop-shadow(0 0 16px rgba(255,106,213,.30));
    }

    /* Home grid */
    .home-grid{
      display:grid;
      gap: 14px;
      grid-template-columns: 1fr;
      margin-top: 10px;
    }
    @media (min-width: 760px){
      .home-grid{ grid-template-columns: 1fr 1fr; }
    }

    .tile{
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.05));
      box-shadow: var(--shadow2);
      padding: 16px 14px;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      transition: transform .12s ease;
    }
    .tile:active{ transform: scale(.99); }
    .tile::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(280px 140px at 30% 25%, rgba(102,226,255,.16), transparent 60%),
        radial-gradient(280px 140px at 80% 70%, rgba(255,106,213,.14), transparent 60%),
        radial-gradient(280px 140px at 60% 40%, rgba(246,211,122,.12), transparent 62%);
      opacity:.9;
      pointer-events:none;
    }
    .tile .t-head{
      position:relative;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .tile .t-head h2{
      margin:0;
      font-size: 18px;
      font-weight: 1000;
    }
    .tile .t-head .icon{
      font-size: 22px;
      filter: drop-shadow(0 10px 16px rgba(0,0,0,.35));
    }
    .tile p{
      position:relative;
      margin: 10px 0 0;
      color: var(--muted);
      line-height: 1.65;
      font-size: 14px;
    }

    /* Content layout inside sections */
    .section-title{
      margin: 10px 0 0;
      font-size: 18px;
      font-weight: 1000;
    }
    .muted{ color: var(--muted); line-height:1.7; }

    .row{ display:grid; gap:10px; margin-top:12px; }
    .field{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.26);
      color: var(--text);
      padding: 12px;
      outline:none;
      font-size: 16px;
    }
    textarea.field{ min-height: 120px; resize: vertical; }

    .msgline{
      min-height: 18px;
      font-size: 13px;
      color: rgba(238,245,255,.78);
    }
    .msgline.ok{ color: rgba(125,255,179,.92); }
    .msgline.bad{ color: rgba(255,107,107,.92); }

    body.flash-red{ animation: redFlash .65s ease-in-out; }
    @keyframes redFlash{
      55%{
        background: radial-gradient(1200px 800px at 50% 40%, rgba(255,43,43,.26), transparent 55%),
                   linear-gradient(160deg, #210000, #0e0000) !important;
      }
    }

    /* puzzles list */
    .puzzle-box{
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      padding: 12px;
      overflow:hidden;
      position:relative;
    }
    .puzzle-box h3{
      margin:0 0 8px;
      font-size: 15px;
      font-weight: 1000;
    }
    .puzzle-box .muted{ font-size: 13px; }

    /* Memory (NO 3D) */
    .grid16{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 12px;
    }
    .mcard{
      height: 76px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      box-shadow: 0 14px 38px rgba(0,0,0,.26);
      cursor:pointer;
      position:relative;
      overflow:hidden;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: transform .12s ease;
    }
    .mcard:active{ transform: scale(.99); }
    .mfront, .mback{
      position:absolute; inset:0;
      display:grid; place-items:center;
      border-radius: 18px;
      transition: opacity .18s ease;
    }
    .mfront{ font-weight: 1000; font-size: 22px; opacity:1; color: rgba(238,245,255,.85); }
    .mback{ font-size: 34px; opacity:0; filter: drop-shadow(0 10px 18px rgba(0,0,0,.35)); }
    .mcard.revealed .mfront{ opacity:0; }
    .mcard.revealed .mback{ opacity:1; }
    .mcard.matched{ outline: 2px solid rgba(125,255,179,.35); cursor:default; }

    /* XO */
    .xo-board{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top:12px;
    }
    .xo-cell{
      height: 88px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      box-shadow: 0 14px 38px rgba(0,0,0,.26);
      display:grid;
      place-items:center;
      font-size: 34px;
      font-weight: 1000;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .xo-cell:active{ transform: scale(.99); }
    .xo-cell.disabled{ cursor:default; opacity:.85; }
  </style>
</head>

<body>
  <div class="emoji-sky" id="emojiSky" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>

  <div class="app">

    <!-- HOME -->
    <section class="panel active" id="p-home">
      <div class="card">
        <div class="topbar">
          <div class="brand">
            <h1>Ramadan Hub</h1>
            <p>Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù„ÙŠ Ø¹Ø§ÙŠØ²Ù‡ â€” ÙƒÙ„Ù‡ Ø´ØºØ§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Fullscreen âœ¨</p>
          </div>
          <span class="chip">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <div class="home-grid">
          <div class="tile" data-go="p-puzzles">
            <div class="t-head">
              <h2>Ø§Ù„Ø§Ù„ØºØ§Ø²</h2>
              <div class="icon">ğŸ§©</div>
            </div>
            <p>Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£Ù„ØºØ§Ø² Ù…ØªÙ†ÙˆØ¹Ø© (Ø¨Ø¯ÙˆÙ† ÙƒØ±ÙˆØª ÙˆÙ„Ø§ ÙƒÙ„Ø§Ù… Ø¨Ø¹Ø¯Ù‡).</p>
          </div>

          <div class="tile" data-go="p-mind">
            <div class="t-head">
              <h2>Ø§Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¹Ù‚Ù„</h2>
              <div class="icon">ğŸ§ </div>
            </div>
            <p>Ù…Ø·Ø§Ø¨Ù‚Ø© 4Ã—4 + XO Ø¶Ø¯ ÙƒÙ…Ø¨ÙŠÙˆØªØ±.</p>
          </div>

          <div class="tile" data-go="p-messages">
            <div class="t-head">
              <h2>Ø®Ø§Ù†Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ( Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ ÙÙ‚Ø· )</h2>
              <div class="icon">âœ‰ï¸</div>
            </div>
            <p>Ø§ÙƒØªØ¨ÙŠ Ø±Ø³Ø§Ù„Ø© ÙˆØ¥Ø±Ø³Ù„ÙŠÙ‡Ø§.</p>
          </div>

          <div class="tile" data-go="p-info">
            <div class="t-head">
              <h2>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ù‡</h2>
              <div class="icon">â„¹ï¸</div>
            </div>
            <p>Ù‚Ø±ÙŠØ¨Ø§Ù‹â€¦</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PUZZLES -->
    <section class="panel" id="p-puzzles">
      <div class="card">
        <div class="topbar">
          <button class="btn ghost" data-back>Ø±Ø¬ÙˆØ¹</button>
          <span class="chip">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <h2 class="section-title">Ø§Ù„Ø§Ù„ØºØ§Ø²</h2>
        <p class="muted">ÙƒÙ„ Ù„ØºØ² Ù‡Ù†Ø§ Ù…Ø³ØªÙ‚Ù„. Ù…ÙÙŠØ´ ÙƒØ±ÙˆØª ØªÙ‡Ù†Ø¦Ø© Ø¨Ø¹Ø¯Ù‡Ø§ â€” Ø²ÙŠ Ù…Ø§ Ø·Ù„Ø¨Øª.</p>

        <!-- Puzzle 1 -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„ØºØ² 1 â€” ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</h3>
          <p class="muted">Ø§ÙƒØªØ¨ÙŠ ÙƒÙ„Ù…Ø© Ù…Ù†: Ø§Ù„Ù†ÙˆÙ… / Ù†ÙˆÙ… / Ø¨Ù†Ø§Ù…</p>

          <div class="row">
            <input class="field" id="pz1" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©..." autocomplete="off" />
            <button class="btn" id="pz1Btn" type="button">ØªØ­Ù‚Ù‘Ù‚</button>
            <div class="msgline" id="pz1Msg"></div>
          </div>
        </div>

        <!-- Puzzle 2 -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„ØºØ² 2 â€” Ø§Ø³Ù… Ø¨Ù†Øª Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ</h3>
          <div class="muted">ğŸ’¡ âœ¨ ğŸŒ™</div>

          <div class="row">
            <input class="field" id="pz2" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Øª..." autocomplete="off" />
            <button class="btn" id="pz2Btn" type="button">ØªØ­Ù‚Ù‘Ù‚</button>
            <button class="btn ghost" id="pz2Hint" type="button">ØªÙ„Ù…ÙŠØ­</button>
            <div class="msgline" id="pz2Msg"></div>
          </div>
        </div>

        <!-- Puzzle 3 -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„ØºØ² 3 â€” ØªØ±ØªÙŠØ¨ Ø§Ù„Ø±Ù…ÙˆØ²</h3>
          <p class="muted">Ø§Ø¶ØºØ·ÙŠ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨: ğŸŒ™ Ø«Ù… â­ Ø«Ù… ğŸ•Œ</p>

          <div class="row">
            <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;">
              <button class="btn ghost" data-seq="moon" type="button">ğŸŒ™</button>
              <button class="btn ghost" data-seq="star" type="button">â­</button>
              <button class="btn ghost" data-seq="mosque" type="button">ğŸ•Œ</button>
            </div>
            <button class="btn ghost" id="pz3Hint" type="button">ØªÙ„Ù…ÙŠØ­</button>
            <div class="msgline" id="pz3Msg"></div>
          </div>
        </div>

        <!-- Puzzle 4 -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„ØºØ² 4 â€” Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚</h3>
          <p class="muted">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„ØµØ­ (Ø´Ø±Ø·: Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ØªÙƒÙˆÙ† ØµØ­).</p>

          <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:10px;">
            <button class="btn ghost" data-door="1" type="button">ğŸšª<br><small>Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„ØµØ­ Ù„ÙŠØ³ Ù‡Ø°Ø§</small></button>
            <button class="btn ghost" data-door="2" type="button">ğŸšª<br><small>Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„ØµØ­ Ù‡Ùˆ Ù‡Ø°Ø§</small></button>
            <button class="btn ghost" data-door="3" type="button">ğŸšª<br><small>Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„ØµØ­ Ù„ÙŠØ³ Ø§Ù„Ø«Ø§Ù†ÙŠ</small></button>
          </div>

          <div class="row">
            <button class="btn ghost" id="pz4Hint" type="button">ØªÙ„Ù…ÙŠØ­</button>
            <div class="msgline" id="pz4Msg"></div>
          </div>
        </div>

        <!-- Puzzle 5 -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„ØºØ² 5 â€” ÙƒÙˆÙ‘Ù† ÙƒÙ„Ù…Ø©</h3>
          <p class="muted">ÙƒÙˆÙ‘Ù† ÙƒÙ„Ù…Ø©: <b>Ø§Ù„Ø±Ø­Ù…Ø©</b> (Ø§Ø®ØªØ§Ø±ÙŠ Ø­Ø±ÙˆÙÙ‡Ø§ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­)</p>

          <div class="row">
            <div id="tiles" style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center;"></div>
            <div id="built" style="text-align:center; font-weight:1000; font-size:18px; padding:12px; border-radius:16px; border:1px solid rgba(255,255,255,.14); background: rgba(0,0,0,.22);">...</div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
              <button class="btn ghost" id="pz5Back" type="button">Ù…Ø³Ø­ Ø¢Ø®Ø± Ø­Ø±Ù</button>
              <button class="btn ghost" id="pz5Reset" type="button">Ø¥Ø¹Ø§Ø¯Ø©</button>
            </div>
            <button class="btn ghost" id="pz5Hint" type="button">ØªÙ„Ù…ÙŠØ­</button>
            <div class="msgline" id="pz5Msg"></div>
          </div>
        </div>

      </div>
    </section>

    <!-- MIND GAMES -->
    <section class="panel" id="p-mind">
      <div class="card">
        <div class="topbar">
          <button class="btn ghost" data-back>Ø±Ø¬ÙˆØ¹</button>
          <span class="chip">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <h2 class="section-title">Ø§Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¹Ù‚Ù„</h2>
        <p class="muted">Ø§Ø®ØªØ§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù„ÙŠ ØªØ­Ø¨Ù‡Ø§.</p>

        <!-- Memory -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© 4Ã—4</h3>
          <p class="muted">Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ² Ø¨ØªØªÙˆØ²Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙƒÙ„ Ù…Ø±Ø©.</p>

          <div class="row">
            <button class="btn" id="memStart" type="button">Ø§Ø¨Ø¯Ø£ / Ø¥Ø¹Ø§Ø¯Ø©</button>
            <div class="grid16" id="memoryGrid"></div>
            <div class="msgline" id="memStatus">ØªÙ…: 0 / 8</div>
          </div>
        </div>

        <!-- XO -->
        <div class="puzzle-box" style="margin-top:12px">
          <h3>XO Ø¶Ø¯ ÙƒÙ…Ø¨ÙŠÙˆØªØ±</h3>
          <p class="muted">Ø¥Ù†Øª: âŒ â€” Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±: â­•</p>

          <div class="xo-board" id="xoBoard"></div>
          <div class="msgline" id="xoStatus">Ø¯ÙˆØ±Ùƒ.</div>

          <div class="row">
            <button class="btn" id="xoRestart" type="button">Ø¥Ø¹Ø§Ø¯Ø©</button>
          </div>
        </div>
      </div>
    </section>

    <!-- MESSAGES -->
    <section class="panel" id="p-messages">
      <div class="card">
        <div class="topbar">
          <button class="btn ghost" data-back>Ø±Ø¬ÙˆØ¹</button>
          <span class="chip">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <h2 class="section-title">Ø®Ø§Ù†Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ( Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ ÙÙ‚Ø· )</h2>
        <p class="muted">Ø§ÙƒØªØ¨ÙŠ Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø¶ØºØ·ÙŠ Ø¥Ø±Ø³Ø§Ù„ â€” Ù‡ØªÙˆØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ù€ Formspree.</p>

        <form class="row" id="msgForm" action="https://formspree.io/f/mykdkqza" method="POST">
          <textarea class="field" name="message" id="msgText" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." required></textarea>
          <input type="hidden" name="page" id="msgPage" />
          <input type="hidden" name="_subject" value="Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ramadan Hub v2" />
          <input type="text" name="_gotcha" style="display:none" />
          <button class="btn pink" id="msgSend" type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
          <div class="msgline" id="msgHint"></div>
        </form>
      </div>
    </section>

    <!-- INFO -->
    <section class="panel" id="p-info">
      <div class="card">
        <div class="topbar">
          <button class="btn ghost" data-back>Ø±Ø¬ÙˆØ¹</button>
          <span class="chip">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <h2 class="section-title">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ù‡</h2>
        <p class="muted">Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
      </div>
    </section>

  </div>

  <footer class="footer">ØµÙÙ†Ø¹ Ø¨ÙˆØ§Ø³Ø·Ø© : Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ v2 .</footer>

  <script>
    /***********************
     * helpers
     ***********************/
    function rand(min,max){ return Math.random()*(max-min)+min; }
    function pick(a){ return a[Math.floor(Math.random()*a.length)]; }
    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }
    function flashRed(){
      document.body.classList.add("flash-red");
      setTimeout(()=>document.body.classList.remove("flash-red"), 700);
    }
    function normalizeArabic(s){
      return (s||"").toLowerCase().trim()
        .replace(/\s+/g,"")
        .replace(/[Ø¥Ø£Ø¢Ø§]/g,"Ø§")
        .replace(/Ù‰/g,"ÙŠ")
        .replace(/Ø¤/g,"Ùˆ")
        .replace(/Ø¦/g,"ÙŠ")
        .replace(/Ø©/g,"Ù‡")
        .replace(/[Ù€Ù‹ÙŒÙÙÙÙÙ‘Ù’]/g,"");
    }

    /***********************
     * background emojis
     ***********************/
    const emojiSky = document.getElementById("emojiSky");
    const RAMADAN_EMOJIS = ["ğŸŒ™","â˜ªï¸","âœ¨","ğŸ•Œ","â­","ğŸ‡","ğŸ’›","ğŸŒŸ","ğŸ¥®","ğŸ•¯ï¸","ğŸ“¿"];
    const EMOJI_COUNT = Math.min(28, Math.max(18, Math.floor(window.innerWidth/44)));
    for(let i=0;i<EMOJI_COUNT;i++){
      const el = document.createElement("span");
      el.className = "e";
      el.textContent = pick(RAMADAN_EMOJIS);
      el.style.left = rand(2,98) + "vw";
      el.style.setProperty("--r", rand(-35,35) + "deg");
      el.style.setProperty("--dx", rand(-18,18).toFixed(1) + "px");
      el.style.animationDuration = rand(9.5, 16.5).toFixed(2) + "s";
      el.style.animationDelay = rand(-12, 0).toFixed(2) + "s";
      emojiSky.appendChild(el);
    }

    /***********************
     * navigation
     ***********************/
    const panels = [...document.querySelectorAll(".panel")];
    function go(id){
      panels.forEach(p => p.classList.toggle("active", p.id === id));
      window.scrollTo(0,0);
    }
    document.querySelectorAll("[data-go]").forEach(el=>{
      el.addEventListener("click", ()=> go(el.dataset.go));
    });
    document.querySelectorAll("[data-back]").forEach(el=>{
      el.addEventListener("click", ()=> go("p-home"));
    });

    /***********************
     * PUZZLES
     ***********************/
    // PZ1
    const pz1 = document.getElementById("pz1");
    const pz1Msg = document.getElementById("pz1Msg");
    const ACCEPT1 = ["Ø§Ù„Ù†ÙˆÙ…","Ù†ÙˆÙ…","Ø¨Ù†Ø§Ù…"].map(normalizeArabic);
    document.getElementById("pz1Btn").addEventListener("click", ()=>{
      const v = normalizeArabic(pz1.value);
      if(ACCEPT1.includes(v)){
        pz1Msg.textContent = "ØµØ­ âœ…";
        pz1Msg.className = "msgline ok";
      }else{
        flashRed();
        pz1Msg.textContent = "ØºÙ„Ø·â€¦ Ø¬Ø±Ù‘Ø¨ÙŠ ØªØ§Ù†ÙŠ ğŸ˜ˆ";
        pz1Msg.className = "msgline bad";
      }
    });

    // PZ2 (Ù†ÙˆØ±)
    const pz2 = document.getElementById("pz2");
    const pz2Msg = document.getElementById("pz2Msg");
    const ENAME_ACCEPT = ["Ù†ÙˆØ±","Ù†ÙˆØ±Ø§","Ù†ÙˆØ±Ù‡"].map(normalizeArabic);
    document.getElementById("pz2Btn").addEventListener("click", ()=>{
      const v = normalizeArabic(pz2.value);
      if(ENAME_ACCEPT.includes(v)){
        pz2Msg.textContent = "ØµØ­ âœ… (Ù†ÙˆØ±)";
        pz2Msg.className = "msgline ok";
      }else{
        flashRed();
        pz2Msg.textContent = "Ù…Ø´ Ù‡ÙŠâ€¦ Ø±ÙƒØ²ÙŠ ÙÙŠ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ² ğŸ‘€";
        pz2Msg.className = "msgline bad";
      }
    });
    document.getElementById("pz2Hint").addEventListener("click", ()=>{
      pz2Msg.textContent = "ØªÙ„Ù…ÙŠØ­: Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø§Ø³Ù… = Ø§Ù„Ø¶ÙˆØ¡.";
      pz2Msg.className = "msgline";
    });

    // PZ3 sequence
    const pz3Msg = document.getElementById("pz3Msg");
    const seqTarget = ["moon","star","mosque"];
    let seq = [];
    document.querySelectorAll("[data-seq]").forEach(b=>{
      b.addEventListener("click", ()=>{
        const k = b.dataset.seq;
        seq.push(k);

        for(let i=0;i<seq.length;i++){
          if(seq[i] !== seqTarget[i]){
            flashRed();
            pz3Msg.textContent = "ØºÙ„Ø·â€¦ Ù…Ù† Ø§Ù„Ø£ÙˆÙ„ ğŸ˜ˆ";
            pz3Msg.className = "msgline bad";
            seq = [];
            return;
          }
        }
        if(seq.length === seqTarget.length){
          pz3Msg.textContent = "Ø§ØªÙØªØ­ âœ…";
          pz3Msg.className = "msgline ok";
          seq = [];
        }else{
          pz3Msg.textContent = `ØªÙ…Ø§Ù…â€¦ ÙƒÙ…Ù„ÙŠ (${seq.length}/3)`;
          pz3Msg.className = "msgline";
        }
      });
    });
    document.getElementById("pz3Hint").addEventListener("click", ()=>{
      pz3Msg.textContent = "ØªÙ„Ù…ÙŠØ­: Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ø§Ù„Ù„ÙŠÙ„â€¦ Ø¨Ø¹Ø¯Ù‡ Ø§Ù„Ù„Ù…Ø¹Ø©â€¦ Ø¢Ø®Ø± Ø­Ø§Ø¬Ø© Ù…ÙƒØ§Ù† Ø§Ù„ØµÙ„Ø§Ø©.";
      pz3Msg.className = "msgline";
    });

    // PZ4 doors (correct = 1)
    const pz4Msg = document.getElementById("pz4Msg");
    const CORRECT_DOOR = 1;
    document.querySelectorAll("[data-door]").forEach(b=>{
      b.addEventListener("click", ()=>{
        const n = Number(b.dataset.door);
        if(n === CORRECT_DOOR){
          pz4Msg.textContent = "ØµØ­ âœ… (Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø£ÙˆÙ„)";
          pz4Msg.className = "msgline ok";
        }else{
          flashRed();
          pz4Msg.textContent = "ØºÙ„Ø·â€¦ ÙÙƒØ±ÙŠ ÙÙŠ Ø´Ø±Ø· (Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø³ ØµØ­).";
          pz4Msg.className = "msgline bad";
        }
      });
    });
    document.getElementById("pz4Hint").addEventListener("click", ()=>{
      pz4Msg.textContent = "ØªÙ„Ù…ÙŠØ­: Ø§ÙØªØ±Ø¶ÙŠ ÙƒÙ„ Ø¨Ø§Ø¨ Ø¥Ù†Ù‡ Ø§Ù„ØµØ­ ÙˆØ´ÙˆÙÙŠ ÙƒØ§Ù… Ø¬Ù…Ù„Ø© Ù‡ØªØ¨Ù‚Ù‰ ØµØ­.";
      pz4Msg.className = "msgline";
    });

    // PZ5 word build (Ø§Ù„Ø±Ø­Ù…Ø©)
    const tilesEl = document.getElementById("tiles");
    const builtEl = document.getElementById("built");
    const pz5Msg = document.getElementById("pz5Msg");
    const TARGET_WORD = "Ø§Ù„Ø±Ø­Ù…Ø©";
    let built = "";
    let tiles = [];

    function setupWord(){
      built = "";
      builtEl.textContent = "...";
      pz5Msg.textContent = "";
      pz5Msg.className = "msgline";

      tiles = shuffle(TARGET_WORD.split(""));
      renderTiles();
    }
    function renderTiles(){
      tilesEl.innerHTML = "";
      tiles.forEach((ch, idx)=>{
        const t = document.createElement("button");
        t.type = "button";
        t.className = "btn ghost";
        t.style.borderRadius = "16px";
        t.style.padding = "12px 0";
        t.style.minWidth = "64px";
        t.textContent = ch;
        t.addEventListener("click", ()=>{
          built += ch;
          tiles.splice(idx,1);
          builtEl.textContent = built || "...";
          renderTiles();
          checkWord();
        });
        tilesEl.appendChild(t);
      });
    }
    function checkWord(){
      if(built.length === TARGET_WORD.length){
        if(built === TARGET_WORD){
          pz5Msg.textContent = "ØµØ­ âœ… (Ø§Ù„Ø±Ø­Ù…Ø©)";
          pz5Msg.className = "msgline ok";
        }else{
          flashRed();
          pz5Msg.textContent = "ØºÙ„Ø·â€¦ Ø¬Ø±Ù‘Ø¨ÙŠ Ø¥Ø¹Ø§Ø¯Ø© ğŸ˜ˆ";
          pz5Msg.className = "msgline bad";
        }
      }
    }
    document.getElementById("pz5Back").addEventListener("click", ()=>{
      if(!built.length) return;
      const last = built[built.length-1];
      built = built.slice(0,-1);
      tiles.push(last);
      builtEl.textContent = built || "...";
      renderTiles();
    });
    document.getElementById("pz5Reset").addEventListener("click", setupWord);
    document.getElementById("pz5Hint").addEventListener("click", ()=>{
      pz5Msg.textContent = "ØªÙ„Ù…ÙŠØ­: ÙƒÙ„Ù…Ø© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø±Ù…Ø¶Ø§Ù† Ù…Ø¹Ù†Ø§Ù‡Ø§ (Ø§Ù„Ù„Ø·Ù ÙˆØ§Ù„Ù…ØºÙØ±Ø©).";
      pz5Msg.className = "msgline";
    });
    setupWord();

    /***********************
     * MIND GAMES
     ***********************/
    // Memory
    const memoryGrid = document.getElementById("memoryGrid");
    const memStatus = document.getElementById("memStatus");
    const memStart = document.getElementById("memStart");

    const MEM_POOL = [
      "ğŸ˜‚","ğŸ¤£","ğŸ˜­","ğŸ¥²","ğŸ˜ˆ","ğŸ™ˆ","ğŸ˜","ğŸ¤",
      "ğŸ’—","ğŸ’˜","âœ¨","ğŸŒ™","â­","ğŸ•Œ","ğŸ‰","ğŸ”¥",
      "ğŸ”","ğŸŒ","ğŸª","ğŸ’¡","ğŸ“Œ","ğŸ§¸","ğŸ‡","ğŸ“¿",
      "ğŸ˜¡","ğŸ˜±","ğŸ¤","ğŸ’€","ğŸ‘€","ğŸ¤¡","ğŸ¥³","ğŸ§ "
    ];
    function pickUnique(pool, n){
      const copy = pool.slice();
      shuffle(copy);
      return copy.slice(0, n);
    }
    let memFirst=null, memLock=false, memMatched=0;

    function buildMemory(){
      memoryGrid.innerHTML = "";
      memFirst=null; memLock=false; memMatched=0;
      memStatus.textContent = "ØªÙ…: 0 / 8";
      const chosen = pickUnique(MEM_POOL, 8);
      const deck = shuffle([...chosen, ...chosen]);

      deck.forEach(emo=>{
        const c = document.createElement("div");
        c.className = "mcard";
        c.dataset.emo = emo;
        c.innerHTML = `<div class="mfront">â”</div><div class="mback">${emo}</div>`;
        c.addEventListener("click", ()=>{
          if(memLock) return;
          if(c.classList.contains("matched")) return;
          if(c.classList.contains("revealed")) return;

          c.classList.add("revealed");

          if(!memFirst){ memFirst = c; return; }
          const a = memFirst, b = c;
          memFirst = null;

          if(a.dataset.emo === b.dataset.emo){
            a.classList.add("matched");
            b.classList.add("matched");
            memMatched++;
            memStatus.textContent = `ØªÙ…: ${memMatched} / 8`;
          }else{
            memLock = true;
            setTimeout(()=>{
              a.classList.remove("revealed");
              b.classList.remove("revealed");
              memLock = false;
            }, 520);
          }
        });
        memoryGrid.appendChild(c);
      });
    }
    memStart.addEventListener("click", buildMemory);

    // XO
    const xoBoardEl = document.getElementById("xoBoard");
    const xoStatus = document.getElementById("xoStatus");
    const xoRestart = document.getElementById("xoRestart");

    let xo = Array(9).fill(null);
    let xoOver = false;

    function winner(b){
      const lines = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      for(const [a,c,d] of lines){
        if(b[a] && b[a]===b[c] && b[a]===b[d]) return b[a];
      }
      if(b.every(Boolean)) return "draw";
      return null;
    }
    function score(b){
      const w = winner(b);
      if(w==="â­•") return 10;
      if(w==="âŒ") return -10;
      return 0;
    }
    function minimax(b, depth, isMax, maxDepth){
      const w = winner(b);
      if(w || depth === maxDepth) return score(b);

      const empties = b.map((v,i)=>v?null:i).filter(v=>v!==null);
      if(isMax){
        let best = -Infinity;
        for(const i of empties){
          b[i] = "â­•";
          best = Math.max(best, minimax(b, depth+1, false, maxDepth));
          b[i] = null;
        }
        return best - depth*0.2;
      }else{
        let best = Infinity;
        for(const i of empties){
          b[i] = "âŒ";
          best = Math.min(best, minimax(b, depth+1, true, maxDepth));
          b[i] = null;
        }
        return best + depth*0.2;
      }
    }
    function bestMove(b){
      const empties = b.map((v,i)=>v?null:i).filter(v=>v!==null);
      if(Math.random() < 0.18){
        return empties[Math.floor(Math.random()*empties.length)];
      }
      let best = -Infinity, move = empties[0];
      for(const i of empties){
        b[i] = "â­•";
        const val = minimax(b, 0, false, 4);
        b[i] = null;
        if(val > best){ best = val; move = i; }
      }
      return move;
    }

    function renderXO(){
      xoBoardEl.innerHTML = "";
      xo.forEach((v, idx)=>{
        const cell = document.createElement("div");
        cell.className = "xo-cell" + (xoOver ? " disabled" : "");
        cell.textContent = v || "";
        cell.addEventListener("click", ()=>{
          if(xoOver) return;
          if(xo[idx]) return;
          xo[idx] = "âŒ";
          afterMove();
        });
        xoBoardEl.appendChild(cell);
      });
    }
    function afterMove(){
      renderXO();
      let w = winner(xo);
      if(w){ endXO(w); return; }

      xoStatus.textContent = "Ø¯ÙˆØ± Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±â€¦";
      setTimeout(()=>{
        const m = bestMove(xo.slice());
        if(m !== undefined && m !== null) xo[m] = "â­•";
        renderXO();
        w = winner(xo);
        if(w) endXO(w);
        else xoStatus.textContent = "Ø¯ÙˆØ±Ùƒ.";
      }, 360);
    }
    function endXO(w){
      xoOver = true;
      if(w === "âŒ"){
        xoStatus.textContent = "ÙØ²Øª âœ…";
        xoStatus.className = "msgline ok";
      }else if(w === "â­•"){
        xoStatus.textContent = "Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙƒØ³Ø¨ ğŸ˜ˆ";
        xoStatus.className = "msgline bad";
      }else{
        xoStatus.textContent = "ØªØ¹Ø§Ø¯Ù„";
        xoStatus.className = "msgline";
      }
    }
    function resetXO(){
      xo = Array(9).fill(null);
      xoOver = false;
      xoStatus.textContent = "Ø¯ÙˆØ±Ùƒ.";
      xoStatus.className = "msgline";
      renderXO();
    }
    xoRestart.addEventListener("click", resetXO);
    resetXO();

    /***********************
     * MESSAGES (Formspree)
     ***********************/
    const msgForm = document.getElementById("msgForm");
    const msgText = document.getElementById("msgText");
    const msgPage = document.getElementById("msgPage");
    const msgSend = document.getElementById("msgSend");
    const msgHint = document.getElementById("msgHint");

    msgForm.addEventListener("submit", async (e)=>{
      e.preventDefault();

      const gotcha = msgForm.querySelector('[name="_gotcha"]').value;
      if(gotcha) return;

      const msg = (msgText.value || "").trim();
      if(!msg){
        flashRed();
        msgText.focus();
        return;
      }

      msgPage.value = location.href;
      msgSend.disabled = true;
      msgHint.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";

      try{
        const fd = new FormData(msgForm);

        let res = await fetch(msgForm.action, {
          method: "POST",
          body: fd,
          headers: { "Accept":"application/json" }
        });

        if(!res.ok){
          const payload = new URLSearchParams();
          for (const [k,v] of fd.entries()) payload.append(k, String(v));
          res = await fetch(msgForm.action, {
            method: "POST",
            headers: {
              "Accept":"application/json",
              "Content-Type":"application/x-www-form-urlencoded"
            },
            body: payload.toString()
          });
        }

        const data = await res.json().catch(()=>({}));
        if(!res.ok){
          const m = data?.error || data?.message || "Ù…Ø±ÙÙˆØ¶";
          msgHint.textContent = `ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (${res.status}): ${m}`;
          msgHint.className = "msgline bad";
          flashRed();
          msgSend.disabled = false;
          return;
        }

        msgHint.textContent = "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ âœ…";
        msgHint.className = "msgline ok";
        msgSend.disabled = false;

      }catch(err){
        msgHint.textContent = "ÙØ´Ù„ Ø§ØªØµØ§Ù„/Ø­Ø¸Ø± Ù…Ù† Ø¥Ø¶Ø§ÙØ©. Ø¬Ø±Ù‘Ø¨ÙŠ Incognito.";
        msgHint.className = "msgline bad";
        flashRed();
        msgSend.disabled = false;
      }
    });

    /***********************
     * Start defaults
     ***********************/
    // start memory empty until user presses start
  </script>
</body>
</html>
